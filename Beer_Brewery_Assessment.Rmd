---
title: "U.S. Beer Brewery Assessment"
author: "Jordan Kassof, Eric McCandless (JKEM Market Research)"
date: "October 5, 2017"
output: 
  html_document:
    keep_md: TRUE
---

## Introduction/Background

Beers, Inc. has contracted with JKEM Market Research to assess the U.S. landscape of breweries and craft beer content.  Specifically, Beers, Inc. has asked JKEM to provide the answers to a few specific questions.  
- How many breweries are present in each state?  
- Which state has the maximum alcoholic beer?  
- Which state has the most bitter beer?     

In addition to providing these answers, JKEM will also provide bar charts, summary statistics, and scatterplots to show further insights.  


## Sources


JKEM Market Research used data from Tibbett's Beer Lovers' Association to conduct this analysis.  Data files used in this analysis:
- Beers.csv
- Breweries.csv


## Additional Information


Additional detailed information about this assessment can be found in the README file within the repository.  


## Analysis/Findings

### How many breweries are present in each state?

The purpose of the following code is to get a count of breweries for each state. That is handled inside the "Q1_Brewery_Per_State.R." From there we map the state abbreviations to state names, and produce a choropleth map to visually display the results. Last, we print a display table of the exact counts for each state.
```{r brewery_by_state, message = FALSE, warning=FALSE, fig.align='center'}
# Source the script for brewery by state analysis from analysis folder
source('./analysis/Q1_Brewery_Per_State.R')

#install.packages("choroplethr")
#install.packages("choroplethrMaps")
library(choroplethr)
map_data <- State_Counts
names(map_data) <- c("region.abb", "value")
map_data$region <- tolower(state.name[match(map_data$region.abb,state.abb)])
map_data$region[is.na(map_data$region)] <- "district of columbia"
state_choropleth(map_data,
                 title = "U.S. Distribution of Breweries",
                 legend = "Number of Breweries",
                 num_colors = 8)
knitr::kable(cbind(State_Counts[1:26, ], rbind(State_Counts[27:51, ], c("", ""))))
```


#### Key insights:  
- Colorado (47), California (39), and Michigan (32) have the most breweries.  
- Other top states with 25+ breweries, include Oregon (29), Texas (28), and Pennsylvania (25).  


### Which state has the maximum alcoholic beer?


The purpose of the following r code is to merge the Beers.csv data set that has AVB (Alcohol by Volume of Beer) by beer with the Breweries.csv dataset that has beers by state.  The new merged file is called Merged_Data.csv.  We also ran the top 6 records and bottom 6 records to check success of merge.

```{r data_merge}
source('./analysis/Q2_Merge.R')
head(All_Data, 6)
tail(All_Data, 6)
```


#### Key insights:
- The output show that the the two data sets are successfully merged into Merged_Data.csv.


The purpose of the following r code is to determine the number of NAs in each column.

```{r NAs}
sapply(All_Data, function(x) sum(is.na(x)))    
```


#### Key insights:
- The ABV (Alcohol by Volume) column has 62 NAs and the IBU (International Bitterness Units) column has 1,005 NAs. No other column has NAs.


The purpose of the following code was to calculate the median of alcohol by volume (ABV) for each state and show a bar chart highlighting data: 

```{r meds_abv, message=FALSE, warning=FALSE, fig.align='center'}
source("./analysis/Q4_Med_IBU_ABV.R")

library(ggplot2)
library(forcats)

ggplot(meds_by_state, aes(x = fct_reorder(State, ABV_Medians))) +
  geom_col(aes(y = ABV_Medians, fill = ABV_Medians)) +
  annotate("text", x = max_state_abv$State, y = max_state_abv$ABV_Medians + max_state_abv$ABV_Medians *.05, label = max_state_abv$ABV_Medians,  size = 3) +
  xlab("States") +
  ylab("Alcohol by Volume") +
  ggtitle("Median ABV by State") +
  theme(
    axis.text.x = element_text(angle = 90, hjust = 1),
    legend.position = 'none'
  )
```



#### Key insights, include:



### Which state has the most bitter beer?  

```{r meds_ibu, fig.align='center'}
ggplot(meds_by_state, aes(x = fct_reorder(State, IBU_Medians))) +
  geom_col(aes(y = IBU_Medians, fill = IBU_Medians)) +
  annotate("text", x = max_state_ibu$State, y = max_state_ibu$IBU_Medians + max_state_ibu$IBU_Medians *.05, label = max_state_ibu$IBU_Medians, size = 3) +
  xlab("States") +
  ylab("International Bitterness Units") +
  ggtitle("Median Bitterness by State") +
  theme(
    axis.text.x = element_text(angle = 90, hjust = 1),
    legend.position = 'none'
  )
```


#### Question 5: State with max ABV beer? State with max IBU beer?

```{r max_beer}
library(dplyr)
All_Data %>%
  top_n(1,ABV) %>%
select(State)
All_Data %>%
  top_n(1,IBU) %>%
select(State)
```

#### Question 6: Summary Statistics for ABV?

```{r abv_summary}
c(StDev = sd(All_Data$ABV, na.rm = TRUE), summary(All_Data$ABV))
```

#### Question 7: Alcohol by Volume vs International Bitterness Units scatterplot with line of best fit

```{r alc_vs_bitter, fig.align='center'}
ggplot(All_Data, aes(x=ABV, y=IBU)) +
    ggtitle('Relationship Between Alcohol by Volume and International Bitterness Units') +
    labs(y= "International Bitterness Units", x = "Alcohol by Volume") +
    xlim(0, .15) +
    ylim(0, 150) +
    geom_point(shape=1, color='red') +    
    geom_smooth(method=lm,   
                se=FALSE)    
```



### Conclusion